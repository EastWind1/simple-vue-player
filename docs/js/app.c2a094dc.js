(function(){"use strict";var t={8842:function(t,e,i){var n=i(9963),l=i(6252);function a(t,e,i,n,a,s){const o=(0,l.up)("PlayerComponent");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(o)])}var s=i(655),o=i(1124),r=i(3577);const c={class:"border",ref:"canvas",style:{width:"40rem",height:"20rem"}},u={class:"form-horizontal"},h=(0,l._)("label",{class:"form-lable",for:"waveColor"},"波形颜色：",-1),d=(0,l._)("br",null,null,-1),f=(0,l._)("br",null,null,-1),y={key:0},p=(0,l._)("div",null,[(0,l._)("span",{id:"upload-success-info",hidden:""},"上传成功"),(0,l._)("span",{id:"upload-fail-info",hidden:""},"上传失败")],-1),v=(0,l._)("br",null,null,-1),w={class:"form-check"},m=(0,l._)("label",{class:"form-check-label",for:"listCycle"}," 列表循环 ",-1),C=(0,l._)("i",{class:"bi bi-list-ol"},null,-1),g=[C],b={key:0,class:"list-group"},_=["onClick"];function S(t,e,i,a,s,o){return(0,l.wg)(),(0,l.iD)("div",{class:"d-flex justify-content-center",onDragover:e[5]||(e[5]=(0,n.iM)((()=>{}),["prevent"])),onDrop:e[6]||(e[6]=(...e)=>t.dropFile&&t.dropFile(...e))},[(0,l._)("div",null,[(0,l._)("div",null,[(0,l._)("canvas",c,null,512)]),(0,l._)("form",u,[h,(0,l.wy)((0,l._)("input",{id:"waveColor",type:"color",class:"form-control-inline","onUpdate:modelValue":e[0]||(e[0]=e=>t.waveColor=e)},null,512),[[n.nr,t.waveColor]])]),d,(0,l._)("div",null,[(0,l._)("audio",{ref:"player",controls:"",onEnded:e[1]||(e[1]=e=>t.playEnd())},null,544)]),f,(0,l._)("div",null,[t.playList.length?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("span",y,"选择或拖拽至任意区域上传")),(0,l._)("input",{ref:"fileInput",class:"form-control",type:"file",accept:".mp3,.wav,.flac",onChange:e[2]||(e[2]=(...e)=>t.fileUpload&&t.fileUpload(...e))},null,544),p]),v,(0,l._)("div",null,[(0,l._)("div",w,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=e=>t.listCycle=e),id:"listCycle"},null,512),[[n.e8,t.listCycle]]),m]),(0,l._)("a",{class:"btn btn-secondary",onClick:e[4]||(e[4]=e=>t.playListButtonClick())},g),t.showPlayList?((0,l.wg)(),(0,l.iD)("ul",b,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.playList,((e,i)=>((0,l.wg)(),(0,l.iD)("li",{key:i,style:(0,r.j5)({color:t.currentPlay==i?"red":"black"}),class:"list-group-item",onClick:e=>t.playListClick(i)},(0,r.zw)(e.name),13,_)))),128))])):(0,l.kq)("",!0)])])],32)}var k,P=i(2482);i(8675),i(3462),i(7380),i(1118),i(6699);function L(t,e,i,n,a,s){return(0,l.wg)(),(0,l.iD)("div",{class:(0,r.C_)(["notify",{show:t.isShow,hidden:!t.isShow,success:2==t.level,warning:1==t.level}])},(0,r.zw)(t.message),3)}(function(t){t[t["INFO"]=0]="INFO",t[t["WARNING"]=1]="WARNING",t[t["SUCCESS"]=2]="SUCCESS"})(k||(k={}));let x=class extends o.w3{constructor(...t){super(...t),(0,P.Z)(this,"isShow",!1),(0,P.Z)(this,"message",""),(0,P.Z)(this,"level",1)}};x=(0,s.gn)([(0,o.Ei)({})],x);var D=x;class Z{static notify(t,e){let i=document.createElement("div");i&&(i.remove(),window.clearTimeout()),i=document.createElement("div"),i.id="notify",document.body.appendChild(i);let l=(0,n.ri)(x).mount("#notify");l.message=t,l.isShow=!0,l.level=e,setTimeout((()=>{l.isShow=!1}),2e3),setTimeout((()=>{i.remove(),window.clearTimeout()}),3e3)}static info(t){this.notify(t,k.INFO)}static warning(t){this.notify(t,k.WARNING)}static success(t){this.notify(t,k.SUCCESS)}}var O=i(3744);const F=(0,O.Z)(D,[["render",L],["__scopeId","data-v-ace6747a"]]);var A=F;let E=class extends o.w3{constructor(...t){super(...t),(0,P.Z)(this,"audioContext",void 0),(0,P.Z)(this,"analySer",void 0),(0,P.Z)(this,"audioSourceNode",void 0),(0,P.Z)(this,"waveData",void 0),(0,P.Z)(this,"waveColor","#0080FF"),(0,P.Z)(this,"player",void 0),(0,P.Z)(this,"listCycle",!0),(0,P.Z)(this,"canvas",void 0),(0,P.Z)(this,"currentPlay",0),(0,P.Z)(this,"playList",[]),(0,P.Z)(this,"showPlayList",!0)}mounted(){this.player=this.$refs.player,this.canvas=this.$refs.canvas}setCurrentAndPlay(t){this.currentPlay=t,this.player.src=this.playList[t].url,setTimeout((()=>{this.audioContext||(this.audioContext=new AudioContext,this.analySer=this.audioContext.createAnalyser(),this.analySer.fftSize=2048,this.audioSourceNode=this.audioContext.createMediaElementSource(this.player),this.audioSourceNode.connect(this.analySer),this.analySer.connect(this.audioContext.destination),this.waveData=new Uint8Array(this.analySer.frequencyBinCount),this.analySer.getByteFrequencyData(this.waveData),setInterval((()=>{this.analySer.getByteFrequencyData(this.waveData),this.paintWave(this.waveData)}),10)),this.player.play()}),1)}playEnd(){this.listCycle&&this.playList.length&&this.setCurrentAndPlay((this.currentPlay+1)%this.playList.length)}fileUpload(){const t=this.$refs.fileInput,e=t.files;e&&e.length&&this.loadFileAndPlay(e[0])}loadFileAndPlay(t){if(!t.type.includes("audio"))return void Z.warning("非音频文件");Z.success("上传成功");const e=this.playList.findIndex((e=>e.name==t.name));let i=0;if(-1!=e)i=e;else{const e=URL.createObjectURL(t);this.playList.push({name:t.name,url:e}),i=this.playList.length-1}this.setCurrentAndPlay(i)}playListClick(t){this.setCurrentAndPlay(t)}playListButtonClick(){this.showPlayList=!this.showPlayList}paintWave(t){const e=this.canvas.getContext("2d");if(e){const i=this.canvas.width,n=i/t.length,l=this.canvas.height;e.clearRect(0,0,i,l),e.moveTo(0,l/2),e.lineTo(i,l/2),e.lineWidth=1,e.stroke(),e.fillStyle=this.waveColor;for(let a=0;a<t.length;a++){const i=t[a]/255*l;e.fillRect(a*n,(l-i)/2,n,i)}}}dropFile(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer&&t.dataTransfer.files.length&&this.loadFileAndPlay(t.dataTransfer.files[0])}};E=(0,s.gn)([(0,o.Ei)({})],E);var N=E;const T=(0,O.Z)(N,[["render",S]]);var I=T;let U=class extends o.w3{};U=(0,s.gn)([(0,o.Ei)({components:{PlayerComponent:I,NotifyComponent:A}})],U);var j=U;const R=(0,O.Z)(j,[["render",a]]);var W=R;(0,n.ri)(W).mount("#app")}},e={};function i(n){var l=e[n];if(void 0!==l)return l.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,i),a.exports}i.m=t,function(){var t=[];i.O=function(e,n,l,a){if(!n){var s=1/0;for(u=0;u<t.length;u++){n=t[u][0],l=t[u][1],a=t[u][2];for(var o=!0,r=0;r<n.length;r++)(!1&a||s>=a)&&Object.keys(i.O).every((function(t){return i.O[t](n[r])}))?n.splice(r--,1):(o=!1,a<s&&(s=a));if(o){t.splice(u--,1);var c=l();void 0!==c&&(e=c)}}return e}a=a||0;for(var u=t.length;u>0&&t[u-1][2]>a;u--)t[u]=t[u-1];t[u]=[n,l,a]}}(),function(){i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};i.O.j=function(e){return 0===t[e]};var e=function(e,n){var l,a,s=n[0],o=n[1],r=n[2],c=0;if(s.some((function(e){return 0!==t[e]}))){for(l in o)i.o(o,l)&&(i.m[l]=o[l]);if(r)var u=r(i)}for(e&&e(n);c<s.length;c++)a=s[c],i.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return i.O(u)},n=self["webpackChunksimple_vue_player"]=self["webpackChunksimple_vue_player"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=i.O(void 0,[998],(function(){return i(8842)}));n=i.O(n)})();
//# sourceMappingURL=app.c2a094dc.js.map